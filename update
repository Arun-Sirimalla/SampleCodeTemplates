<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<head>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>

<style>
@media print {
	thead {display: table-header-group;}
	<!--tfoot {display: table-header-group;}-->
	@page {size: landscape; }
	button {display: collapse;}
	div.myDivToPrint {background-color: white;
		top: 0;
		left: 0;
		margin: 0;
		}
	img.backdrop {display: block;}
	a.print {display: none;}
	#contentRow {padding-top:0px;}
	#s4-titlerow {display:none !important;visibility: collapse !important; }
	#s4-statusbarcontainer{ display:none !important; visibility: collapse !important; }
	#s4-topheader2 { display:none !important; visibility: collapse !important;}
	#s4-leftpanel { display:none !important; visibility: collapse !important;}
	.ms-core-pageTitle {display:none !important; visibility: collapse !important;}
	#MSO_ContentTable { margin: 0 0 0 0 }

	}
@media screen {
	img.backdrop {display: none;}
	a.print {display: block;}
	}
H1.PageHeader {color: rgb(129,0,0); 
	font-family: Arial;
	font-size:16pt;
	font-weight:bold;
	}
H2.FirstRow {color: rgb(129,0,0); 
	font-family: Times New Roman;
	font-size:14pt;
	}
H3.TableHeader {font-family: Arial;
	font-size:11pt;
	white-space:nowrap;
	}
H4.PageFooter {font-family: Arial;
	font-size:11pt;
	font-weight:bold;
	color: rgb(129,0,0);
	}
tfoot {font-family: Arial;
	font-size:11pt;
	font-weight:Bold;
	}
table{font-family: Times New Roman;
	font-size:12pt;
	}

			
</style>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">WAY, RICHARD B</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">WAY, RICHARD B</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ContentTypeId msdt:dt="string">0x01010022B278E3F54B00429F7016D1A446C2DB</mso:ContentTypeId>
</mso:CustomDocumentProperties>
</xml><![endif]-->
<title></title></head>
<body>

<div style="margin-left:50px;">
	<a class="print" onClick="window.print();return false"><img src="https://wigov.sharepoint.com/sites/dot-dbm/bitsproj/WebParts/UniversalProjectTemplate/printicon.jpg" alt="Print" style="width:16px; height:16px;"/> Print</a>
</div>
<div class="myDivToPrint">
	<!--<img class="backdrop" src="https://wigov.sharepoint.com/sites/dot-dbm/bitsproj/WebParts/UniversalProjectTemplate/white.jpg" style="height:100%;width:100%;float:left;">
	-->
	<div>
		<table id="tableProjects" style="width:100%;table-layout: fixed;">
			<thead>
				<tr style="min-height:2px;">
					<td colspan=6><hr style="display: block; border-style: solid; border-width: 1px;" /></td>
				</tr>
				<tr style="min-height:10px;">
					<td colspan=6><H1 class="PageHeader">WisDOT Project Status Report - <span id="spanDivision"></span> Projects</td>
				</tr>
				<tr style="min-height:2px;">
					<td colspan=6><hr style="display: block; border-style: solid; border-width: 1px; border-color: rgb(129,0,0);"/></td>
				</tr>
				<tr style="min-height:10px;">
					<td><h3 class="TableHeader">Project Name</h3></td>
					<td><h3 class="TableHeader">Project Objective</h3></td>
					<td><h3 class="TableHeader">Project Manager</h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader">Project Status</h3></td>
					<td><h3 class="TableHeader">Status As Of</h3></td>
				</tr>
				<tr style="min-height:10px;">
					<td><h3 class="TableHeader">Request Number</h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader">Project Leader</h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader">Status Notes</h3></td>
				</tr>
				<tr style="min-height:10px;">
					<td><h3 class="TableHeader">Start-End Dates</h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader">Business Sponsor</h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
				</tr>
				<tr style="min-height:10px;">
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
					<td><h3 class="TableHeader"></h3></td>
				</tr>
				<tr style="min-height:4px;">
					<td colspan=6><hr style="display: block; border-style: solid; border-width: 2px; border-color: rgb(129,0,0);"/></td>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td colspan=6><h2 class="FirstRow">Projects</h2></td>
				</tr>
			<tfoot>
				<tr>
					<td colspan=6><div style="margin-top:10px;">Project Status Legend:</div></td>
				</tr>
				<tr>
					<td colspan=6>
						<table>
							<tr>
								<td style="width:33%;">
									<span style="background-color:rgb(75,255,75); padding-left: 5px; padding-right: 5px;">G</span> = Active and on track, according to plan.
								</td>
								<td style="width:33%;">
									<span style="background-color:rgb(255,255,75); padding-left: 5px; padding-right: 5px;">Y</span> = Some measure of concern.
								</td>
								<td style="width:33%;">
									<span style="background-color:rgb(255,75,75); padding-left: 5px; padding-right: 5px;">R</span> = Needs immediate attention or significantly behind schedule.
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td colspan=1><div id="divDate"></div></td>
					<td colspan=5><h4 class="PageFooter">Division of Business Management / Bureau of Information Technology Services</h4></td>
				</tr>
			</tfoot>
		</table>
	</div>
</div>

<script>
	//Check if console is active
	if ( ! window.console ) console = { log: function(){} };

	//Create regular expression
	var regexp = /Pages\/(\S*?)-/;

	//Grabs current page URL
	var path = window.location.href.toString();

	//Gets the Division from URL
	var Division = path.match(regexp)[1];
	$("#spanDivision").html(Division);
	
	$("#divDate").html(formatDate(new Date()));
	
	function formatDate(targetDate)
	{
		var dd = targetDate.getDate();
		var mm = targetDate.getMonth()+1; //January is 0!
		var yyyy = targetDate.getFullYear();

		if(dd<10) {
			dd='0'+dd
		} 

		if(mm<10) {
			mm='0'+mm
		} 
		return mm+'/'+dd+'/'+yyyy;
	}
	
	$(function() {
    console.log("Entering BITS aJax function");
	console.log("https://wigov.sharepoint.com/sites/dot-dbm/bitsproj/_api/web/Lists(guid'd3afc01c-ca9d-4248-90ff-99de956700dc')" + 
                "/items?$select=Title,Project_x0020_State,Project_x0020_State_x0020_Date,Number,PDW_x0020_Manager/Name,Div/Title,Sponsor2/Name,Project_x0020_Lead/Name," + 
				"StatusDescription,ProjectStatus/Title,ProjectStatusBudget/Title,ProjectStatusSchedule/Title,ProjectObjective,Modified,Start_x0020_Date,End_x0020_Date" +
                "&$expand=Div,PDW_x0020_Manager,Project_x0020_Lead,Sponsor2,ProjectStatus,ProjectStatusBudget,ProjectStatusSchedule" +
				"&$filter=((((Project_x0020_State%20ne%20'Inactive')%20and%20(Project_x0020_State%20ne%20'Completed'))%20and%20(Project_x0020_State%20ne%20'Cancelled'))%20and%20(Div/Title%20eq%20'"+Division+"'))" +
				"&$orderby=Title");

    $.ajax({
            //BITS Project URL, lookup fields and Person and Group fields need to be selected and expanded, all other fields just need to be selected           
            url:"https://wigov.sharepoint.com/sites/dot-dbm/bitsproj/_api/web/Lists(guid'd3afc01c-ca9d-4248-90ff-99de956700dc')" + 
                "/items?$select=Title,Project_x0020_State,Project_x0020_State_x0020_Date,Number,PDW_x0020_Manager/Name,Div/Title,Sponsor2/Name,Project_x0020_Lead/Name," + 
				"StatusDescription,ProjectStatus/Title,ProjectStatusBudget/Title,ProjectStatusSchedule/Title,ProjectObjective,Modified,Start_x0020_Date,End_x0020_Date" +
                "&$expand=Div,PDW_x0020_Manager,Project_x0020_Lead,Sponsor2,ProjectStatus,ProjectStatusBudget,ProjectStatusSchedule" +
				"&$filter=((((Project_x0020_State%20ne%20'Inactive')%20and%20(Project_x0020_State%20ne%20'Completed'))%20and%20(Project_x0020_State%20ne%20'Cancelled'))%20and%20(Div/Title%20eq%20'"+Division+"'))" +
				"&$orderby=Title",
            headers: {"Accept": "application/json;odata=verbose"}, 
            type: "GET", 
            cache: false,
            //Async set to false, means the statement that is being called has to complete before the next statement can be called.
            async: false,      


		
			//((((Project_x0020_State%20ne%20'Inactive')%20and%20(Project_x0020_State%20ne%20'Completed'))%20and%20(Project_x0020_State%20ne%20'Cancelled'))%20and%20(Div/Title%20eq%20'DTSD'))

    }).success(function (data) {
        console.log("Leaving BITS aJax function");
		var sLine = "<tr style='height:22px; page-break-before: auto; vertical-align:top;'>" +
						"<td style='vertical-align:top;' colspan=2><b>[Title]</b></td>" +
						"<td style='vertical-align:top;'>[PDW Manager]</td>" +
						"<td style='vertical-align:top;'></td>" +
						"<td style='vertical-align:top;'><div style='width: 66px; float: left;'>Overall: [Status]</div></td>" +
						"<td style='vertical-align:top;'>[Status Date]</td></tr>" +
					"<tr style='height:22px; page-break-before: avoid;'>" +
						"<td style='vertical-align:top;'><b>[Project #]</b></td>" +
						"<td style='vertical-align:top;' rowspan=4><div style='max-height:144px; overflow:hidden'>[Project Objective]</div></td>" +
						"<td style='vertical-align:top;'>[Project Leader]</td>" +
						"<td style='vertical-align:top;'>[Start Date]</td>" +
						"<td style='vertical-align:top;'><div style='width: 66; float: left;'>Budget: [Status Budget]</div></td>" +
						"<td style='vertical-align:top;' rowspan=4><div style='max-height:144px; overflow:hidden'>[Status Description]</div></td></tr>" +
					"<tr style='height:22px; page-break-before: avoid;'>" +
						"<td style='vertical-align:top;'>[Start-End]</td>" +
						"<td style='vertical-align:top;'>[Business Sponsor]</td>" +
						"<td style='vertical-align:top;'>[Finish Date]</td>" +
						"<td style='vertical-align:top;'><div style='width: 66px; float: left;'>Schedule: [Status Schedule]</div></td></tr>"+ 
					"<tr style='height:22px; page-break-before: avoid;'>" +
						"<td style='vertical-align:top;'>[PMM Type]</td>" +
						"<td style='vertical-align:top;'>[Business Area Expert]</td></tr>" +
					"<tr style='height:162px; page-break-before: avoid;'><td style='vertical-align:top;'><br/></td></tr>"
		var sBlock = "";
	    $.each(data.d.results, function(key, value) {
			var sThisLine = sLine;
           
		    //[Title]					Title
            if(value.Title === undefined || value.Title == null)
			{ sThisLine=sThisLine.replace("[Title]", "") }
            else
			{ sThisLine=sThisLine.replace("[Title]", value.Title)}
		
			//[PDW Manager]				PDW_x0020_Manager/Name
			if(value.PDW_x0020_Manager.Name)
			{
				pdwMan = "*" +  value.PDW_x0020_Manager.Name; 
				var pwholeName = pdwMan.indexOf("membership");
				pwholeName = pwholeName + 11;
				pdwMan = pdwMan.substring(pwholeName);
				var pfirstNameIndex = pdwMan.indexOf(".");
				var plastNameIndex = pdwMan.indexOf("@");
				var pfirstName = pdwMan.substring(1, pfirstNameIndex);
				var pfirstLetterFN = pdwMan.substring(0,1).toUpperCase();
				var plastName = pdwMan.substring(pfirstNameIndex+2,plastNameIndex);
				var pfirstLetterLN = pdwMan.substring(pfirstNameIndex+1,pfirstNameIndex+2).toUpperCase();
				pdwMan = pfirstLetterFN + pfirstName + " " + pfirstLetterLN + plastName;
				pdwMan = pdwMan.replace(/[0-9]/g, '');
				sThisLine=sThisLine.replace("[PDW Manager]", pdwMan);
			}
			else
			{ sThisLine=sThisLine.replace("[PDW Manager]", ""); }
			
			//[State]					Project_x0020_State
			if(value.Project_x0020_State === undefined || value.Project_x0020_State == null)
			{ sThisLine=sThisLine.replace("[State]", "") }
            else
			{ sThisLine=sThisLine.replace("[State]", value.Project_x0020_State)}
			
			//[Status]					ProjectStatus/Title	undefined
			if(value.ProjectStatus)
			{ if(value.ProjectStatus.Title)
			 { sThisLine=sThisLine.replace("[Status]", getStatusBlock(value.ProjectStatus.Title));}
			 else
			 { sThisLine=sThisLine.replace("[Status]", ""); }
			}
            else
			{ sThisLine=sThisLine.replace("[Status]", ""); }
			
			
			//[Project #]				Number
			if(value.Number === undefined || value.Number == null)
			{ sThisLine=sThisLine.replace("[Project #]", "") }
            else
			{ sThisLine=sThisLine.replace("[Project #]", value.Number)}
			
			//[Project Objective]		ProjectObjective
			if(value.ProjectObjective === undefined || value.ProjectObjective == null)
			{ sThisLine=sThisLine.replace("[Project Objective]", "") }
            else
			{ sThisLine=sThisLine.replace("[Project Objective]", value.ProjectObjective)}
			
			//[Project Leader]			Project_x0020_Lead/Name
			if(value.Project_x0020_Lead.Name)
			{
				pdwMan = "*" +  value.Project_x0020_Lead.Name; 
				var pwholeName = pdwMan.indexOf("membership");
				pwholeName = pwholeName + 11;
				pdwMan = pdwMan.substring(pwholeName);
				var pfirstNameIndex = pdwMan.indexOf(".");
				var plastNameIndex = pdwMan.indexOf("@");
				var pfirstName = pdwMan.substring(1, pfirstNameIndex);
				var pfirstLetterFN = pdwMan.substring(0,1).toUpperCase();
				var plastName = pdwMan.substring(pfirstNameIndex+2,plastNameIndex);
				var pfirstLetterLN = pdwMan.substring(pfirstNameIndex+1,pfirstNameIndex+2).toUpperCase();
				pdwMan = pfirstLetterFN + pfirstName + " " + pfirstLetterLN + plastName;
				pdwMan = pdwMan.replace(/[0-9]/g, '');
				sThisLine=sThisLine.replace("[Project Leader]", pdwMan);
			}
			else
			{ sThisLine=sThisLine.replace("[Project Leader]", ""); }
									
			//[Status Budget]			ProjectStatusBudget/Title	undefined
			if(value.ProjectStatusBudget)
			{ if(value.ProjectStatusBudget.Title)
			 { sThisLine=sThisLine.replace("[Status Budget]", getStatusBlock(value.ProjectStatusBudget.Title));}
			 else
			 { sThisLine=sThisLine.replace("[Status Budget]", ""); }
			}
            else
			{ sThisLine=sThisLine.replace("[Status Budget]", ""); }
			
			
			//[Status Description]		StatusDescription
			if(value.StatusDescription === undefined || value.StatusDescription == null)
			{ sThisLine=sThisLine.replace("[Status Description]", "") }
            else
			{ sThisLine=sThisLine.replace("[Status Description]", value.StatusDescription)}
			
			//[Business Sponsor]		Sponsor2/Name
			if(value.Sponsor2)
			{
				if (value.Sponsor2.results)
				{
					var Sponsors = "";
					var index, len;
					for(index = 0, len = value.Sponsor2.results.length; index < len; ++index) 
					{
						pdwMan = "*" +  value.Sponsor2.results[index].Name; 
						var pwholeName = pdwMan.indexOf("membership");
						pwholeName = pwholeName + 11;
						pdwMan = pdwMan.substring(pwholeName);
						var pfirstNameIndex = pdwMan.indexOf(".");
						var plastNameIndex = pdwMan.indexOf("@");
						var pfirstName = pdwMan.substring(1, pfirstNameIndex);
						var pfirstLetterFN = pdwMan.substring(0,1).toUpperCase();
						var plastName = pdwMan.substring(pfirstNameIndex+2,plastNameIndex);
						var pfirstLetterLN = pdwMan.substring(pfirstNameIndex+1,pfirstNameIndex+2).toUpperCase();
						pdwMan = pfirstLetterFN + pfirstName + " " + pfirstLetterLN + plastName;
						pdwMan = pdwMan.replace(/[0-9]/g, '');
						Sponsors += pdwMan + ", ";
					}
					sThisLine=sThisLine.replace("[Business Sponsor]", Sponsors.substring(0,Sponsors.length-2));
				}
				else
				{ sThisLine=sThisLine.replace("[Business Sponsor]", ""); }
			}
			else
			{ sThisLine=sThisLine.replace("[Business Sponsor]", ""); }
			
			//[Status Schedule]			ProjectStatusSchedule/Title	undefined
			if(value.ProjectStatusSchedule)
			{ if(value.ProjectStatusSchedule.Title)
			 { sThisLine=sThisLine.replace("[Status Schedule]", getStatusBlock(value.ProjectStatusSchedule.Title));}
			 else
			 { sThisLine=sThisLine.replace("[Status Schedule]", ""); }
			}
            else
			{ sThisLine=sThisLine.replace("[Status Schedule]", ""); }
			
			//[Status Date]				Modified
			if(value.Modified === undefined || value.Modified == null)
			{ sThisLine=sThisLine.replace("[Status Date]", "") }
            else
			{ sThisLine=sThisLine.replace("[Status Date]", formatDate(new Date(value.Modified)))}
			
			
			//[Start-End]
			var sStartEnd = "";
			if(value.Start_x0020_Date === undefined || value.Start_x0020_Date == null)
			{ sStartEnd = ""; }
            else
			{ sStartEnd = formatDate(new Date(value.Start_x0020_Date));}
			if(value.End_x0020_Date === undefined || value.End_x0020_Date == null)
			{ sStartEnd = ""; }
            else
			{ sStartEnd += " - " + formatDate(new Date(value.End_x0020_Date));}
			sThisLine=sThisLine.replace("[Start-End]",sStartEnd)
			
			//[Start Date]				Not supported
			sThisLine=sThisLine.replace("[Start Date]", "")
			//[Project Type]			Not supported
			sThisLine=sThisLine.replace("[Project Type]", "")
			//[Finish Date]				Not supported
			sThisLine=sThisLine.replace("[Finish Date]", "")
			//[PMM Type]				Not supported
			sThisLine=sThisLine.replace("[PMM Type]", "")
			//[Business Area Expert]	Not supported		
			sThisLine=sThisLine.replace("[Business Area Expert]", "")
			$('#tableProjects').append(sThisLine);
        }); 

    });
});
	
function getStatusBlock(statusTitle)
{
	if (statusTitle == "GREEN") return "<div style='float:Right; background-color:rgb(75,255,75); padding-left: 5px; padding-right: 5px;'>G</div>";
	if (statusTitle == "YELLOW") return "<div style='float:Right; background-color:rgb(255,255,75); padding-left: 5px; padding-right: 5px;'>Y</div>";
	if (statusTitle == "RED") return "<div style='float:Right; background-color:rgb(255,75,75); padding-left: 5px; padding-right: 5px;'>R</div>";
	if (statusTitle == "-") return "<div style='float:Right; background-color:rgb(125,125,125); padding-left: 5px; padding-right: 5px;'>-</div>";
	return "";
}
</script>



</body>
</html><script type="text/javascript">
	var g_duration = 116;
var g_iisLatency = 2;
var g_requireJSDone = new Date().getTime();
</script>
